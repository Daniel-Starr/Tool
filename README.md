# 工程建设数据与三维模型自动挂接工具

## 项目简介

本项目是一个专业的工程建设数据处理工具，主要用于电力工程建设中的三维模型数据与实际工程数据的自动匹配和挂接。该工具支持多种数据格式的处理，包括CBM、FAM文件和Excel数据表格。

## 主要功能

### 🔧 核心功能模块

1. **GIM文件解压缩**
   - 支持7z压缩格式的GIM文件解压
   - 自动提取CBM和FAM工程文件
   - 批量处理多个压缩包

2. **设备清单导出**
   - 自动从CBM文件中提取设备信息
   - 生成标准化的Excel设备清单
   - 支持设备类型分类和过滤

3. **参数文件处理**
   - Excel参数文件数据预处理
   - 数据格式标准化和清洗
   - 支持多种电压等级识别

4. **智能匹配算法**
   - 基于模糊匹配的设备自动关联
   - 多维度匹配策略（设备名称、类型、电压等级）
   - 匹配结果评分和置信度分析

5. **数据载入与挂接**
   - 实物ID自动分配
   - FAM文件更新和同步
   - 数据完整性验证

6. **结果导出**
   - 生成匹配报告Excel文件
   - JSON格式数据导出
   - 统计分析报表

### 🎯 专业特性

- **电力工程专用**：针对500kV变电站等电力工程优化
- **高准确率匹配**：采用先进的模糊匹配算法，支持中文设备名称
- **批量处理**：支持大规模工程数据的批量自动化处理
- **可视化界面**：提供友好的GUI界面，降低使用门槛
- **数据验证**：内置多重数据验证机制，确保结果准确性

## 技术架构

### 开发语言
- **Python 3.8+**

### 核心依赖
- `pandas` - 数据处理和分析
- `openpyxl` - Excel文件操作
- `fuzzywuzzy` - 模糊字符串匹配
- `python-Levenshtein` - 字符串相似度计算
- `py7zr` - 7z压缩文件处理
- `tkinter` - GUI界面框架

### 项目结构
```
Tool/
├── Pygui.py              # 主GUI界面
├── matching01.py         # 核心匹配算法
├── extract_ui.py         # 文件提取模块
├── transition_ui.py      # 数据转换模块
├── parmeter_ui.py        # 参数处理模块
├── matcher_ui.py         # 匹配处理模块
├── load_ui.py           # 数据载入模块
├── save_excel_ui.py     # 结果保存模块
├── compress_ui.py       # 压缩文件处理
├── device_display_ui.py # 设备显示模块
├── trann_ui.py          # 训练数据模块
├── build_exe.py         # 打包构建脚本
├── requirements.txt     # 依赖列表
└── output/              # 输出文件目录
```

## 安装和使用

### 环境要求
- Python 3.8 或更高版本
- Windows 操作系统（推荐）

### 安装依赖
```bash
pip install -r requirements.txt
```

### 运行应用
```bash
python Pygui.py
```

### 打包为可执行文件
```bash
python build_exe.py
```

## 使用流程

1. **导入GIM文件** - 选择并解压缩工程GIM文件
2. **导出设备清单** - 从CBM文件中提取设备信息
3. **处理参数文件** - 导入并预处理Excel参数文件
4. **执行自动匹配** - 运行智能匹配算法
5. **数据载入** - 将匹配结果载入到FAM文件
6. **保存结果** - 导出最终的匹配报告和数据文件

## 支持的文件格式

- **输入格式**：
  - `.7z` - GIM压缩包
  - `.cbm` - 三维模型数据文件
  - `.fam` - 设备族文件
  - `.xlsx` - Excel参数文件

- **输出格式**：
  - `.xlsx` - Excel报告和清单
  - `.json` - JSON数据文件
  - 更新的`.fam`文件

## 应用场景

- 电力变电站建设项目
- 500kV及以上电压等级工程
- 三维设计与施工数据对接
- 设备清单管理和核对
- 工程竣工验收数据整理

## 版本信息

当前版本支持的主要特性：
- 智能设备匹配算法
- 多电压等级识别
- 批量文件处理
- 可视化操作界面
- 详细匹配报告生成

## 注意事项

1. 请确保输入的Excel文件格式正确，包含必要的字段
2. 大型GIM文件处理可能需要较长时间，请耐心等待
3. 建议在处理前备份原始数据文件
4. 首次运行时可能需要安装相关依赖包

## 贡献和反馈

如果您在使用过程中遇到问题或有改进建议，欢迎提交Issue或Pull Request。

## 许可证

本项目仅供学习和研究使用。

---

**开发团队**：专业电力工程数据处理团队  
**技术支持**：如有技术问题，请通过GitHub Issues联系我们